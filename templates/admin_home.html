<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8"/>
        <title>Favorite Barber</title>
        <meta content="width=device-width, initial-scale=1" name="viewport"/>
        <meta content="Webflow" name="generator"/>
        <link href="/static/css/admin_home.css" rel="stylesheet" type="text/css"/>
        <script type="text/javascript">
            !function(o, c) {
                var n = c.documentElement
                  , t = " w-mod-";
                n.className += t + "js",
                ("ontouchstart"in o || o.DocumentTouch && c instanceof DocumentTouch) && (n.className += t + "touch")
            }(window, document);
        </script>
        <link href="/static/images/Fav-Barber Logo.ico" rel="shortcut icon" type="image/x-icon"/>
        <link href="/static/images/Fav-Barber Logo.png" rel="apple-touch-icon"/>
    </head>
    <body class='body'>
        <div>
            <div>
                <header id="nav" class="sticky-nav">
                    <nav class="w-container">
                        <ul role="list" class="nav-grid w-list-unstyled">
                            <li id="w-node-c249ff46-f0ce-8935-1977-33360bdf8f97-bb7c1f44">
                                <a href="/" class="nav-logo-link">
                                    <img src="/static/images/Fav-Barber Logo.png" sizes="(max-width: 479px) 224.21875px, (max-width: 767px) 38vw, 228.015625px" alt="" class="nav-logo"/>
                                </a>
                            </li>
                            <li>
                                <a href="/about" class="nav-link">About</a>
                            </li>
                            <li>
                                <a href="/set/appointments" class="nav-link">Set Appointment</a>
                            </li>
                            <li>
                                <a href="/reviews" class="nav-link">Reviews</a>
                            </li>
                        </ul>
                    </nav>
                </header>
            </div>
            <h1 id='name' >Welcome {{name}}</h1>
            <a href="/add/review" class="button-9 w-button">Add Review</a>
            <button id ='password_change' onclick="change_password('{{name}}')" class="button-4 w-button">Change Password</button>
            <button id ='name_change' onclick="change_name('{{name}}')" class="button-8 w-button">Change Name</button>
            <button id ='email_change' onclick="change_email('{{name}}')" class="button-6 w-button">Change Email</button>
            <div>
                {% for i in splitted %}
                        {% if i | check_len == 2 %}
                            <div style='display: inline-flex;'>
                                <div>
                                    <div class="div-block-9" style='left: -150px;'>
                                        <button onclick="edit_comment('{{i[0]['id']}}')" class="button-10 w-button">Edit</button>
                                        <img src="{{i[0]['before_file_path']}}" loading="lazy" width="190" height="500" sizes="190px" alt="" class="image-6"/>
                                        <img src="{{i[0]['before_file_path']}}" loading="lazy" width="190" height="500" sizes="190px" alt="" class="image-7"/>
                                        <div>
                                            <h1 class="heading-6"> &nbsp;&nbsp;&nbsp;Before</h1>
                                        </div>
                                        <div>
                                            <img src="/static/images/hearts.png" loading="lazy" width="88" sizes="88px" alt="" class="image-8"/>
                                            <div class="text-block-2">{{i[0]['after_file_path']}}</div>
                                        </div>
                                        <div>
                                            <h1 class="heading-7">After      </h1>
                                        </div>
                                        <div>
                                            <blockquote id='com_{{i[0]["id"]}}' class="block-quote-3">{{i[0]['comment']}}</blockquote>
                                        </div>
                                    </div>
                                </div>
                                <div class="div-block-10" style="left: -60px; top: 0px;">
                                    <button onclick="edit_comment('{{i[1]['id']}}')" class="button-10 w-button">Edit</button>
                                        <img src="{{i[1]['before_file_path']}}" loading="lazy" width="190" height="500" sizes="190px" alt="" class="image-6"/>
                                        <img src="{{i[1]['before_file_path']}}" loading="lazy" width="190" height="500" sizes="190px" alt="" class="image-7"/>
                                        <div>
                                            <h1 class="heading-6"> &nbsp;&nbsp;&nbsp;Before</h1>
                                        </div>
                                        <div>
                                            <img src="/static/images/hearts.png" loading="lazy" width="88" sizes="88px" alt="" class="image-8"/>
                                            <div class="text-block-2">{{i[1]['after_file_path']}}</div>
                                        </div>
                                        <div>
                                            <h1 class="heading-7">After      </h1>
                                        </div>
                                        <div>
                                            <blockquote id='com_{{i[0]["id"]}}' class="block-quote-3">{{i[1]['comment']}}</blockquote>
                                        </div>
                                </div>
                            </div>
                        {% else %}
                            {% if i | check_type([]) %}
                                <div>
                                    <div class="div-block-9" style='left: -370px;'>
                                        <button onclick="edit_comment('{{i[0]['id']}}')" class="button-10 w-button">Edit</button>
                                        <img src="{{i[0]['before_file_path']}}" loading="lazy" width="190" height="500" sizes="190px" alt="" class="image-6"/>
                                        <img src="{{i[0]['before_file_path']}}" loading="lazy" width="190" height="500" sizes="190px" alt="" class="image-7"/>
                                        <div>
                                            <h1 class="heading-6"> &nbsp;&nbsp;&nbsp;Before</h1>
                                        </div>
                                        <div>
                                            <img src="/static/images/hearts.png" loading="lazy" width="88" sizes="88px" alt="" class="image-8"/>
                                            <div class="text-block-2">{{i[0]['after_file_path']}}</div>
                                        </div>
                                        <div>
                                            <h1 class="heading-7">After      </h1>
                                        </div>
                                        <div>
                                            <blockquote id='com_{{i[0]["id"]}}' class="block-quote-3">{{i[0]['comment']}}</blockquote>
                                        </div>
                                    </div>
                                </div>
                            {% else %}
                                <div>
                                    <div class="div-block-9" style='left: -370px;'>
                                        <button onclick="edit_comment('{{i['id']}}')" class="button-10 w-button">Edit</button>
                                        <img src="{{i['before_file_path']}}" loading="lazy" width="190" height="500" sizes="190px" alt="" class="image-6"/>
                                        <img src="{{i['before_file_path']}}" loading="lazy" width="190" height="500" sizes="190px" alt="" class="image-7"/>
                                        <div>
                                            <h1 class="heading-6"> &nbsp;&nbsp;&nbsp;Before</h1>
                                        </div>
                                        <div>
                                            <img src="/static/images/hearts.png" loading="lazy" width="88" sizes="88px" alt="" class="image-8"/>
                                            <div class="text-block-2">{{i['after_file_path']}}</div>
                                        </div>
                                        <div>
                                            <h1 class="heading-7">After      </h1>
                                        </div>
                                        <div>
                                            <blockquote id='com_{{i["id"]}}' class="block-quote-3">{{i[0]['comment']}}</blockquote>
                                        </div>
                                    </div>
                                </div>
                            {% endif %}
                        {% endif %}
                {% endfor %}
            </div>
            <script>
                function change_email(name){
                    let input = window.prompt('Type in your new email');
                    if (input != null){
                        fetch('/change_email', {

                            // Declare what type of data we're sending
                            headers: {
                            'Content-Type': 'application/json',
                            },
        
                            // Specify the method
                            method: 'POST',
        
                            // A JSON payload
                            body: JSON.stringify({
                                "content": name,
                                'new_email': input,
                            })
                            }).then(function (response) { // At this point, Flask has printed our JSON
                            return response.text();
                            }).then(function (text) {
        
                            // Should be 'OK' if everything was successful
                            //response =JSON.parse(text);
                            console.log("Post response: ");
                            console.log(text)
                            if (text != 'Issue'){
                                alert('Success, reload page to see change')
                            }else {
                                alert('Problem changing Password')
                            }
                        });
                    }
                }
                function change_password(name){
                    let input = window.prompt('Type in your new password');
                    if (input != null){
                        fetch('/change_password', {

                            // Declare what type of data we're sending
                            headers: {
                            'Content-Type': 'application/json',
                            },
        
                            // Specify the method
                            method: 'POST',
        
                            // A JSON payload
                            body: JSON.stringify({
                                "content": name,
                                'new_password': input,
                            })
                            }).then(function (response) { // At this point, Flask has printed our JSON
                            return response.text();
                            }).then(function (text) {
        
                            // Should be 'OK' if everything was successful
                            //response =JSON.parse(text);
                            console.log("Post response: ");
                            console.log(text)
                            if (text != 'Issue'){
                                alert('Success, reload page to see change')
                            }else {
                                alert('Problem changing Password')
                            }
                        });
                    }
                }
                function change_name(name){
                    let input = window.prompt('Type in your new name');
                    if (input != null){
                        fetch('/change_name', {

                            // Declare what type of data we're sending
                            headers: {
                            'Content-Type': 'application/json',
                            },
        
                            // Specify the method
                            method: 'POST',
        
                            // A JSON payload
                            body: JSON.stringify({
                                "content": name,
                                'new_name': input,
                            })
                            }).then(function (response) { // At this point, Flask has printed our JSON
                            return response.text();
                            }).then(function (text) {
        
                            // Should be 'OK' if everything was successful
                            //response =JSON.parse(text);
                            console.log("Post response: ");
                            console.log(text)
                            if (text != 'Issue'){
                                document.getElementById("name").innerHTML = "Welcome"+ text;
                                document.getElementById('password_change').onclick = "change_password('"+text+"')";
                                document.getElementById('name_change').onclick = "change_name('"+text+"')";
                                document.getElementById('email_change').onclick = "change_email('"+text+"')";
                                alert('Success, reload page to see change')
                            }else {
                                alert('Problem changing Name')
                            }
                        });
                    }
                }
                function edit_comment(id){
                    console.log(id);
                    console.log('clicked me')
                    let input = window.prompt('Type in your new comment');
                    console.log(input);
                    if (input != null){
                        fetch('/change_comment', {

                            // Declare what type of data we're sending
                            headers: {
                            'Content-Type': 'application/json',
                            },
        
                            // Specify the method
                            method: 'POST',
        
                            // A JSON payload
                            body: JSON.stringify({
                                "content": id,
                                'new_comment': input,
                            })
                            }).then(function (response) { // At this point, Flask has printed our JSON
                            return response.text();
                            }).then(function (text) {
        
                            // Should be 'OK' if everything was successful
                            //response =JSON.parse(text);
                            console.log("Post response: ");
                            console.log(text)
                            if (text != 'Issue'){
                                document.getElementById("com_"+id).innerHTML = text;
                                alert('Success, reload page to see change')
                            }else {
                                alert('Problem changing comment')
                            }
                        });
                    }
                }
            </script>
        </div>
    </body>
</html>